!function(){var e=function(e,t){return void 0==e||null==e?t:e},t=function(t,i,n){t.hasError=!1,t.delimiter=e(t.delimiter,[","]),t.data=e(t.data,[]),t.selected=e(t.selected,[]),t.allowOutsideDataSet=e(t.allowOutsideDataSet,!1),t.sameInput=e(t.sameInput,!1),t.default_input={},t.theme=e(t.theme,"default"),t.typehead=e(t.typehead,!0),t.displayField=e(t.displayField,"text"),t.placeholder=e(t.placeholder,"Enter Text with , separated"),t.active_index=-1,t.check_data=function(e,n){return i("filter")(e,function(e,i){return e[t.displayField]===n})[0]},t.strip_delimiters=function(e){for(var i=t.delimiter.length,n=0;n<i;n++)e=e.replace(t.delimiter[n],"");return e},t.check_delimiter=function(e){for(var i=t.delimiter.length,n=0;n<i;n++)if(e.indexOf(t.delimiter[n])>-1)return!0;return!1},t.on_input_keyup=function(e){var i="";if(void 0!=t.input&&(i=t.strip_delimiters(t.input)),void 0!=t.input&&1==t.check_delimiter(t.input))return void(""!=i&&t.processor(i));if(13==e.keyCode&&""!=i)return void t.processor(i);if(8==e.keyCode&&""==i.slice(0,t.getCursorPosition(e.target))){var n=t.selected.length-1;return n==t.active_index&&(t.remove(t.selected[t.active_index]),n=-1),void t.moveToTag(e,n)}return 46==e.keyCode&&""==i.slice(t.getCursorPosition(e.target),i.length)?void t.remove(t.selected[t.active_index]):void 0},t.on_input_keydown=function(e){var i="";if(void 0!=t.input&&(i=t.input.replace(t.delimiter,"")),37==e.keyCode&&0==t.getCursorPosition(e.target)){var n=t.active_index==-1||0==t.active_index?t.selected.length-1:t.active_index-1;return void t.moveToTag(e,n)}if(39==e.keyCode&&t.getCursorPosition(e.target)==i.length){var a=t.active_index==-1||t.active_index==t.selected.length-1?0:t.active_index+1;return void t.moveToTag(e,a)}},t.getCursorPosition=function(e){var t=0;if(document.selection){e.focus();var i=document.selection.createRange();i.moveStart("character",-e.value.length),t=i.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t},t.update=function(e){if(t.selected.length<t.max||void 0==t.max){t.selected.push(angular.copy(e)),t.input="",t.hasError=!1;var i={action:"added",item:e};t.onTagAdded({event:i})}else{t.hasError=!0;var i={action:"maximum",item:e};t.onTagMaximum({event:i})}},t.remove=function(e){t.selected=i("filter")(t.selected,function(t,i){return t!==e}),t.active_index=-1;var n={action:"removed",item:e};t.onTagRemoved({event:n})},t.return_value=function(e,i){return void 0==e?(t.default_input[""+t.displayField]=i,t.default_input):e},t.moveToTag=function(e,i){for(var n=0,a=angular.element(e.target.parentNode.parentNode).find("li"),r=a.length,n=0;n<r-1;n++)if(n==i)if(t.active_index!=i){t.active_index=i,angular.element(a[n]).addClass("active");var e={action:"active",item:t.selected[t.active_index]};t.onTagActive({event:e})}else t.active_index=-1,angular.element(a[n]).removeClass("active");else angular.element(a[n]).removeClass("active")},t.processor=function(e){var i=t.check_data(t.data,e),a=t.check_data(t.selected,e);return t.allowOutsideDataSet&&t.sameInput?void t.update(t.return_value(i,e)):t.allowOutsideDataSet&&!t.sameInput?void(void 0==a?t.update(t.return_value(i,e)):t.hasError=!0):t.allowOutsideDataSet||t.sameInput?!t.allowOutsideDataSet&&t.sameInput?void(void 0!=i?t.update(i):t.hasError=!0):(t.hasError=!0,void n.error("Error, Existing before in our output , or not among data set")):void(void 0!=i&&void 0==a?t.update(i):t.hasError=!0)}};t.$inject=["$scope","$filter","$log"];var i=function(){return{restrict:"E",scope:{type:"@",theme:"@",data:"=",selected:"=",sameInput:"=?",allowOutsideDataSet:"=",typehead:"=?",displayField:"@",placeholder:"@",delimiter:"=?",onTagAdded:"&",onTagRemoved:"&",onTagActive:"&",max:"=",onTagMaximum:"&"},templateUrl:function(e,t){return"angular-tag/templates/"+t.type+".html"},controller:t,link:function(e,t,i){}}},n=function(){return{restrict:"A",link:function(e,t,i){e.$watch(i.focusMe,function(e){e===!0&&t[0].focus()})}}},a=angular.module("angular-tag",["angular-tag/templates"]);a.directive("tagMe",i).directive("focusMe",n)}(),angular.module("angular-tag/templates",[]).run(["$templateCache",function(e){e.put("angular-tag/templates/input.html",'<div id="main-tag">\r\n<div class="tag-container">\r\n <ul ng-class="[\'tag\',{focus:isFocus},theme ]" ng-click="isFocus=true" ng-keydown="direction_keys($event)">\r\n    <li ng-repeat="select in selected" ng-click="(moveToTag($event,$index)) ">\r\n      {{select[displayField]}}  <a href="javascript:void(0)" ng-click="remove(select)">&times;</a>\r\n    </li>\r\n<li>\r\n    <input ng-class="{error:hasError}" ng-model="input" ng-keyup="on_input_keyup($event)" ng-keydown="on_input_keydown($event)" ng-focus="isFocus=true" ng-blur="isFocus=false" focus-me="isFocus"\r\n         type="input" placeholder="{{placeholder}}"  >\r\n</li>\r\n </ul>\r\n</div>\r\n\r\n<ul class="tag-typehead" ng-show="input.length && typehead && results.length " >\r\n    <li class="animate-repeat" ng-repeat="item in data | filter:input as results">\r\n       <a href="javascript:void(0)" ng-click="processor(item[displayField])">{{item[displayField]}}</a>\r\n    </li>\r\n    <!--<li class="animate-repeat" ng-if="results.length == 0">\r\n        <strong>No results found...</strong>\r\n    </li>-->\r\n</ul>\r\n</div>')}]);